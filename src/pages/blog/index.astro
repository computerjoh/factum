---
import { getCollection } from "astro:content";
import Navbar from "../../components/Navbar.astro";
import { navLinks } from "../../data/navLinks";
import Layout from "../../layouts/Layout.astro";

const posts = (await getCollection("blog", ({ data }) => !data.draft)).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const formatDate = (date: Date) =>
	date.toLocaleDateString("en-US", {
		month: "long",
		day: "numeric",
		year: "numeric",
	});
---

<Layout
	title="Blog | Factum Performance and Wellness"
	description="Insights, updates, and stories from the Factum Performance and Wellness team."
>
	<Navbar navLinks={navLinks} />
	<main id="main" class="scroll-mt-28">
		<section class="border-b border-slate-200 bg-white text-slate-900">
			<div
				class="mx-auto flex max-w-6xl flex-col gap-5 px-4 py-16 sm:px-6 lg:px-0 lg:py-20"
			>
				<p
					class="text-xs font-semibold uppercase tracking-[0.2em] text-rose-600"
				>
					Factum Blog
				</p>
				<h1 class="text-4xl font-semibold leading-tight sm:text-5xl">
					Training insights, nutrition notes, and gym updates
				</h1>
				<p class="max-w-3xl text-lg text-slate-700">
					Posts from the floor of Factum Performance and Wellness.
					Learn how our coaches program, fuel, and recover
					athletesâ€”and see what&apos;s coming up next.
				</p>
			</div>
		</section>

		<section class="mx-auto max-w-6xl px-4 py-16 sm:px-6 lg:px-0 lg:py-24">
			<div class="space-y-10">
				<div class="space-y-6">
					<p
						class="text-xs font-semibold uppercase tracking-[0.2em] text-rose-600"
					>
						Latest posts
					</p>
				</div>

				{
					posts.length === 0 ? (
						<div class="rounded-2xl border border-dashed border-rose-200 bg-rose-50 px-6 py-5 text-slate-800">
							<p class="text-sm font-semibold text-rose-700">
								No posts yet
							</p>
							<p class="text-sm text-slate-700">
								We&apos;re lining up the first articles now.
								Check back soon or tell us what you want to read
								about in the contact form.
							</p>
						</div>
					) : (
						<div class="flex flex-col divide-y divide-slate-200 rounded-2xl border border-slate-200 bg-white">
							{posts.map((post) => (
								<a
									class="flex flex-col gap-2 px-6 py-5 transition hover:bg-rose-50"
									href={`/blog/${post.slug}`}
								>
									<p class="text-xs font-semibold uppercase tracking-[0.12em] text-rose-600">
										{formatDate(post.data.pubDate)}
									</p>
									<p class="text-lg font-semibold text-slate-900">
										{post.data.title}
									</p>
									<p class="text-sm text-slate-700">
										{post.data.description}
									</p>
									{post.data.author && (
										<p class="text-xs font-semibold uppercase tracking-[0.1em] text-slate-500">
											By {post.data.author}
										</p>
									)}
								</a>
							))}
						</div>
					)
				}
			</div>
		</section>
	</main>
</Layout>
